## Dubbo

#### 1. 为什么要进行系统拆分？

- 系统代码量庞大，多人维护，修改代码牵一发动全身
- 代码上传容易冲突，修改自己的模块，影响别人的功能
- 每次上线心惊胆战，很可能需要全回归测试，耗时耗力
- 代码耦合严重，很难进行技术升级

#### 2. 如何进行系统拆分？

- 按模块功能拆分
- 按业务细节拆分

#### 3. 拆分后不用dubbo可行吗？

- 完全可行，大不了就用Http进行通信，不过像服务注册与发现，负载均衡，延迟超时，服务调用等乱七八糟的问题都需要自己去Cover。
- 如果用了Dubbo，上述问题Dubbo已经进行了封装，开袋即食，让程序员专注于业务代码

#### 4. Dubbo工作原理？

- Dubbo分为Service层、Config层、Proxy层、Register层、Cluster层、Monitor层、Protocol层、Transport层和Serialize层九层
- 服务提供者上线后，注册到注册中心，然后通过代理生成向外暴露的接口。消费者消费的时候查询注册中心对应服务提供者地址，然后通过代理和负载均衡策略与服务提供者进行通信，通信后服务提供者通过代理再返回消费者的消息。

#### 5. 注册中心挂了还能继续通信吗？

- 可以继续通信，消费者会缓存一定时间的服务提供者地址。

#### 6. Dubbo都支持哪些通信协议？

- 默认是Dubbo协议，单一长连接，NIO异步通信，基于hessian序列化协议
- rmi协议，多个短连接，使用Java二进制序列化，适用于消费者和提供者数量差不多的情况
- hessian协议，多个短连接，适用于提供者数量比消费者多的情况
- http协议，使用json序列化
- webservice协议，使用SOAP文本序列化

#### 7. Dubbo支持哪些负载均衡策略

- random负载均衡：默认策略，可为不同的提供者的实例设置不同的权重，按照权重来进行负载均衡，权重越高流量越大。
- roundrobin 负载均衡：轮询，默认将流量均匀的打到各个机器上去。
- least active 负载均衡：自动感知，如果某个机器性能越差，接收到的流量会越少，越活跃的机器接收到的流量越大
- consistanthash 负载均衡：一致性hash算法，相同参数请求一定会分发到一个provider上去，如果provider挂掉，会基于虚拟节点均匀分配剩余的的流量，抖动不会太大。

#### 8. Dubbo有哪些集群容错策略

- failover cluster模式：失败自动切换，自动重试其他机器，默认。
- failfast cluster模式：一次调用失败就立即失效，常见于写操作。
- failsafe cluster模式：出现异常时忽略掉，常用于不重要的接口调用，比如记录日志。
- failback cluster模式：失败了后台自动记录请求，然后定时重发，比较适合于写消息队列这种
- forking cluster模式：并行调用多个provider，只要一个成功就立即返回
- broadcast cluster模式：逐个调用所有的provider

#### 9. Dubbo动态代理策略

- 默认使用javassist动态字节码生成，创建代理列，但是可以通过spi扩展机制配置自己的动态代理策略

#### 10. Dubbo的SPI是什么？

- SPI(Service provider interface)

#### 11. 如何基于Dubbo实现服务治理、服务降级与重试？

